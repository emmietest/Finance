!function(){"use strict";function t(){t=function(){return n};var e,n={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(e){u=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:T(t,n,s)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=p;var h="suspendedStart",f="suspendedYield",v="executing",y="completed",m={};function g(){}function w(){}function b(){}var _={};u(_,s,(function(){return this}));var S=Object.getPrototypeOf,A=S&&S(S(N([])));A&&A!==r&&o.call(A,s)&&(_=A);var E=b.prototype=g.prototype=Object.create(_);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,i,a,s){var c=d(t[r],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var r;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,r){n(t,o,e,r)}))}return r=r?r.then(i,i):i()}})}function T(t,n,r){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?y:f,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function x(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function N(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(o.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return w.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=u(b,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},n.awrap=function(t){return{__await:t}},k(C.prototype),u(C.prototype,c,(function(){return this})),n.AsyncIterator=C,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var a=new C(p(t,e,r,o),i);return n.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,l,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=N,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},n}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function s(t){n(a,o,i,s,c,"next",t)}function c(t){n(a,o,i,s,c,"throw",t)}s(void 0)}))}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d(r.key),r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var h=new RegExp("/([0-9]{0,})/","g"),f={getItem:function(t){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(t,e,n,r,o,i){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+a+(o?"; domain="+o:"")+(r?"; path="+r:"")+(i?"; secure":""),!0},removeItem:function(t,e,n){return!(!t||!this.hasItem(t))&&(document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(e?"; path="+e:""),!0)},hasItem:function(t){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),e=0;e<t.length;e++)t[e]=decodeURIComponent(t[e]);return t}},v=function(){return window.performance&&window.performance.timing?window.performance.timing.navigationStart:-1},y=function(){return+new Date},m=function(t,n){return"function"!=typeof n?(console.error("[apptel:api.addListener] The listener callback must be a function, the given type is ".concat(e(n))),!1):"string"!=typeof t?(console.error("[apptel:api.addListener] The event name must be a string, the given type is ".concat(e(t))),!1):(void 0===this.events[t]&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(n))},g=function(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners.forEach((function(t){t(e)}))},w={timeout:15e3,delayedReporting:!0},b=["userSegment","tna","deviceMemory","profileId"],_=["initiator","childActions","areasLoaded","customLong1","customLong2","customString1","customString2"],S=s({"aa|online_banking_menu|requestpaymentsandrequests":{name:"$$transfer_flow"},"aa|online_banking_menu|requestpaymentactivity":{name:"$$payment_activity",description:"Payment activity entry"},"aa|online_banking_menu|transfermoney":{name:"$$single_door",description:"User payments entry"}},"aa|online_banking_menu|requestpaymentactivity",{name:"$$payment_activty",description:"payment activity from menu."}),A=function(){function t(e){o(this,t),this.options=Object.assign(w,e||{}),this.approvedActionProps=_,this.approvedSessionProps=b,this._list=S}return a(t,[{key:"get",value:function(t){return this._list[t]}},{key:"addEntry",value:function(t,e){if(this._list[t]&&window.console.warn("[apptel:actionConfig.addEntry] key".concat(t," already exists")),!e.hasOwnProperty("name")&&!e.hasOwnProperty("description"))throw new Error("expected object with name and description property");this._list[t]=e}}]),t}(),E=function(){function t(e,n,r,i,a){o(this,t),this.id=e,this.name=n,this.start=i||y(),this.stop=null,this.dur=null,this.type=r,this.isNested=!1,this.isTransient=!1,this.props=a||{},this.dtExported=!1,this.dtIgnoreReason=null}return a(t,[{key:"end",value:function(t,e){this.start=Math.round(e||this.start),this.stop=Math.round(t||this.stop||y()),this.dur=Math.round(this.stop-this.start)}},{key:"updateTiming",value:function(t,e){this.stop=Math.round(t||this.stop),this.start=Math.round(e||this.start),this.dur=Math.round(this.stop-this.start)}}]),t}(),k=function(){function t(e){o(this,t),this._options=e,this._currentIndex=0,this._processed={}}return a(t,[{key:"visitSpan",value:function(t){var e=this;if(null!=t.stop){var n={start:t.start-window.performance.timing.navigationStart,duration:t.dur,detail:t};if(n.start>=0){if(this._processed[t.id])return;window.performance.measure(t.name,n),this._processed[t.id]=!0,t.children&&t.children.forEach((function(t){e.visitSpan(t)}))}else console.warn("[apptel:devtoolsExporter.visitSpan] Measured options negative: ".concat(t.start," - ").concat(window.performance.timing.navigationStart),t)}}},{key:"createDevtoolsGraph",value:function(t){var e={id:0,name:"root",children:[]};(t=t.sort((function(t,e){return t.start>e.start?1:-1}))).forEach((function(n){n.name.substring(0,3);var r=t.find((function(t){return n!=t&&"svc|"!=t.name.substring(0,4)&&n.start>t.start&&(!t.stop||n.stop<=t.stop)}));n.parent=r?r.id:e.id}));var n=t.reduce((function(t,e,n){return t[e.id]=n,t}),{});return t.forEach((function(r){var o=t[n[r.parent]]||e;o.children=[].concat(l(o.children||[]),[r])})),e}},{key:"run",value:function(t,e){var n=this;try{var r=t.filter((function(t){return null!=t.dur}));this.createDevtoolsGraph(r).children.forEach((function(t){n.visitSpan(t)}))}catch(t){console.error("[apptel:devtoolsExporter:run] ".concat(t))}}}]),t}(),C="apptel-dte",T={repeatSameActionThreshold:500,reportAnalyticActions:!0,managedActionTypes:["ca","aggregate","composite","associate","async","aa"],clientActionMinTime:20,svcActionMinTime:300,analyticActionMinTime:50,defaultActionMinTime:50,shouldSerializeSpans:!1},x=function(){function t(e){o(this,t),this.options=Object.assign(T,e||{}),this._dtrum=this.options.dtrum,this._lastClientActionStopTime=0,this._lastAnalyticActionStopTime=0,this.addListener=m.bind(this),this.dispatch=g.bind(this),this.events={},this._reportedSpans={},this._shouldSerializeSpans=this.options.shouldSerializeSpans;var n=this;if(this._shouldSerializeSpans&&window.sessionStorage){var r=window.sessionStorage.getItem(C);if(r){console.debug("[apptel:DynatraceExporter] found data in sessionStore");var i=JSON.parse(r);n._reportedSpans=i}window.addEventListener("beforeunload",(function(t){Object.keys(n._reportedSpans).length>0&&(console.debug("[apptel:DynatraceExporter:beforeunload] saving ".concat(Object.keys(n._reportedSpans).length," reported spans")),window.sessionStorage.setItem(C,JSON.stringify(n._reportedSpans)))})),window.sessionStorage.removeItem(C)}}return a(t,[{key:"run",value:function(t,e){var n=this;(e=e||y(),window.dtrum)&&(this._dtrum=window.dtrum,n.filterSpansForDynatrace(t,e).forEach((function(t){n.reportSpan(t)})))}},{key:"filterSpansForDynatrace",value:function(t,e){var n=this,r=e,o=[],i=[],a=[],s=[];t.forEach((function(t){if(t.isTransient||t.dtExported)t.dtIgnoreReason="transient";else if(n.options.managedActionTypes.includes(t.type)&&null!=t.dur&&t.start<r&&(r=t.start),null!=t.dur)switch(t.type){case"ca":t.dur>=n.options.clientActionMinTime&&o.push(t);break;case"aa":t.dur>=n.options.analyticActionMinTime&&i.push(t);break;case"svc":t.dur>=n.options.svcActionMinTime&&a.push(t);break;default:t.dur>=n.options.defaultActionMinTime&&s.push(t)}}));var c=[];a.forEach((function(t){if(t.start<=n._lastClientActionStopTime||n.options.reportAnalyticActions&&t.start<=n._lastAnalyticActionStopTime)t.dtIgnoreReason="started before previous managed action ended";else if(t.stop<=r){var e=n.findConcurrentSpan(t,o);!e&&n.options.reportAnalyticActions&&(e=n.findConcurrentSpan(t,i)),e?t.dtIgnoreReason="overlaps a current managed span (".concat(e.name,")"):c.push(t)}})),s.forEach((function(t){if(t.start<=n._lastClientActionStopTime)t.dtIgnoreReason="started before previous managed CA action ended";else if(t.stop<=r){var e=n.findConcurrentSpan(t,o);e?t.dtIgnoreReason="overlaps a current managed CA span (".concat(e.name,")"):c.push(t)}})),n.options.reportAnalyticActions&&i.forEach((function(t){var e=n.findConcurrentSpan(t,o);e?t.dtIgnoreReason="overlaps a current CA span (".concat(e.name,")"):(t.stop>n._lastAnalyticActionStopTime&&(n._lastAnalyticActionStopTime=t.stop),c.push(t))})),o.forEach((function(t){t.stop>n._lastClientActionStopTime&&(n._lastClientActionStopTime=t.stop),c.push(t)})),c=c.sort((function(t,e){return t.start>e.start?1:-1}));var l=[];return c=c.filter((function(t){return l.includes(t.name)?(t.dtIgnoreReason="duplicate",!1):(l.push(t.name),!0)}))}},{key:"findConcurrentSpan",value:function(t,e){return e.find((function(e){return t.stop>=e.start&&t.start<=e.stop}))}},{key:"reportSpan",value:function(t){var e={},n=[];if(Object.hasOwn(this._reportedSpans,t.name)&&("@"==t.name.substring(0,1)||"svc"==t.name.substring(0,3)||"$$"==t.name.substring(0,2)))return t.dtIgnoreReason="key action already reported once",void(t.dtExported=!1);window.actionManager.clientAction.actionProps={};var r=this._dtrum.enterAction(t.name,"custom",t.start);if(Object.keys(t.props).length>0){for(var o=0,i=Object.entries(t.props);o<i.length;o++){var a=c(i[o],2),s=a[0],l=a[1];_.includes(s)?window.actionManager.clientAction.actionProps[s]=l:e[s]=l}Object.entries(e).forEach((function(t){var e=c(t,2),r=e[0],o=e[1];n.push("".concat(r,":").concat(o))})),window.actionManager.clientAction.actionProps.other=n.join("|")}this._dtrum.leaveAction(r,t.stop,t.start),t.dtExported=!0,this._reportedSpans[t.name]=t}}]),t}(),L={repeatSameActionThreshold:500,reportDefaultActions:!1,targetExt:["css","js","json"],targetTypes:["mark","measure"]},I=function(){function t(e){o(this,t),this._options=e}return a(t,[{key:"exportStats",value:function(){return{entries:window.performance.getEntries().filter((function(t){return"measure"==t.entryType||"resource"==t.entryType&&L.targetExt.includes(t.name.split(".").pop()),!0}))}}}]),t}(),O="apptel",N=function(){function t(e){o(this,t),this._lastActionTimestamp=null,this._lastActionName=null,this._sessionStart=v(),this._spans=[],this._spanCounter=0,this._exporters=[],this._collectionRunning=!1,this._collectionScheduled=!1,this._processSpanHandle=-1,this.options=e,this.actionConfig=new A(e),this.perfSupported=!!window.performance&&!!window.performance.mark&&!!window.performance.measure,this.perfEnabled=!(!window.localStorage||!window.localStorage.getItem("perf")),this.events={},this._unreportedSpans={},this._shouldSerializeSpans=!1,this.longTaskStats={longTaskCount:0,longTaskDur:0,longTaskEntries:[]},this.initialize()}return a(t,[{key:"loadState",value:function(){if(window.sessionStorage){var t=window.sessionStorage.getItem(O);if(t){console.debug("[apptel:initialize] found data in sessionStore");var e=JSON.parse(t)._spans.filter((function(t){var e=y()-t.start;return e<3e4&&e>0}));if(e.length){var n=e.reduce((function(t,e){return+e.id>+t.id?e:t}));self._spans=e.map((function(t){return console.debug("[apptel:initialize] found span ".concat(t.name)),new E(t.id,t.name,t.type,t.start,t.props)})),this._spanCounter=n&&n.id||0}window.sessionStorage.removeItem(O)}}}},{key:"saveState",value:function(){try{window.sessionStorage.setItem(O,JSON.stringify({_spans:this._spans.map((function(t){return console.debug(t),t}))}))}catch(t){logger.error("[apptel:saveState] error occured in saveState ".concat(t))}}},{key:"initialize",value:function(){var t=this;try{window.dtrum&&window.dtrum.enableManualPageDetection(),window.dtrum&&window.dtrum.setLoadEndManually()}catch(t){console.error("[apptel:initialize] error setting load and page event behavior ".concat(t))}t._shouldSerializeSpans&&t.loadState(),window.addEventListener("beforeunload",(function(e){t._spans.length>0&&(console.debug("[apptel:beforeunload] saving ".concat(t._spans.length," processing spans")),t._shouldSerializeSpans?t.saveState():t._processSpans())}));var e=window.performance.clearMarks;this.perfSupported&&(window.performance.clearMarks=function(t){if(arguments.length&&"string"==typeof arguments[0])try{e.apply(window.performance,Array.prototype.slice.call(arguments))}catch(t){console.error("[apptel:initialize] error applying clear mark")}else if(console.warn("[apptel:api.initialize] something called clearMarks with no markName which clears all the performance marks logged in the browser.  If you really want to do this pass true."),!0===t)try{e.apply(window.performance,Array.prototype.slice.call(arguments))}catch(t){console.error("[apptel:initialize] error applying clear mark")}}),this.perfSupported&&this._exporters.push(new k);var n=new x(window.dtrum,this.options);this._exporters.push(n),this.ensureCollectScheduled(),this.addListener("longtaskObserved",(function(e){t.longTaskStats.longTaskCount+=1,t.longTaskStats.longTaskDur+=e.duration,t.longTaskStats.longTaskEntries.push(e)}))}},{key:"endSession",value:function(){try{var t=y();this._processSpans(t),window.dtrum&&window.dtrum.endSession()}catch(t){console.error("[apptel:endsession] ".concat(t))}}},{key:"ensureCollectScheduled",value:function(){this._processSpanHandle=window.setInterval(this.processSpans.bind(this),15e3)}},{key:"removeListener",value:function(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners=this.events[t].listeners.filter((function(t){return t.toString()!==e.toString()}))}},{key:"addListener",value:function(t,n){return"function"!=typeof n?(console.error("[apptel:api.addListener] The listener callback must be a function, the given type is ".concat(e(n))),!1):"string"!=typeof t?(console.error("[apptel:api.addListener] The event name must be a string, the given type is ".concat(e(t))),!1):(void 0===this.events[t]&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(n))}},{key:"dispatch",value:function(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners.forEach((function(t){t(e)}))}},{key:"logEvent",value:function(t){var e=this.enterAction(t);return"$$dashboard-load"==t?this.leaveAction(e,y(),this._sessionStart):this.leaveAction(e),e}},{key:"setSessionProperties",value:function(t){t&&this.dispatch("sessionChanged",t)}},{key:"signalLoadEnd",value:function(){window.dtrum&&window.dtrum.signalLoadEnd()}},{key:"registerClientAction",value:function(t,e){this.actionConfig.addEntry(t,e)}},{key:"getCurrentTime",value:function(){return console.warn("[apptel:api.getCurrentTime] depricated, do not use"),y()}},{key:"reportError",value:function(t,e){window.dtrum&&window.dtrum.reportCustomError(t,e,null,!0)}},{key:"getSpanByName",value:function(t){return this._spans.sort((function(t,e){return e.start-t.start})).find((function(e){return e.name==t}))}},{key:"processSpans",value:function(){var t=y();this._collectionRunning=!0,window.requestIdleCallback(this._processSpans.bind(this,t),{timeout:5e3})}},{key:"_processSpans",value:function(t){var e=this;try{e.dispatch("processSpans:begin",e._spans),e._spans.length>0&&(e._exporters.forEach((function(n){n.run(e._spans,t)})),e._spans.filter((function(e){return e.dtIgnoreReason||0==e.dtExported&&e.start+3e4<=t})).forEach((function(t){var n={reason:t.dtIgnoreReason||"timeout",span:t};e._unreportedSpans[t.name]?e._unreportedSpans[t.name].push(n):e._unreportedSpans[t.name]=[n]})),e._spans=e._spans.filter((function(e){return 0==e.dtExported&&!e.dtIgnoreReason&&e.start+3e4>t})))}catch(t){console.error("[apptel.api._processSpans] ".concat(t))}this._collectionRunning=!1}},{key:"identifyUser",value:function(t){window.dtrum&&window.dtrum.identifyUser(t)}},{key:"leaveAction",value:function(t,n,r){var o;"boolean"==typeof n&&(console.warn("[apptel:leaveAction] an invalid argument was passed to leaveAction - ".concat(t)),n=null),"boolean"==typeof r&&(console.warn("[apptel:leaveAction] an invalid argument was passed to leaveAction - ".concat(t)),r=null),"number"==typeof r&&(r=Math.round(r)),"number"==typeof n&&(n=Math.round(n)),"string"==typeof t||t instanceof String?(o=t,t=this.getSpanByName(o)):"object"==e(t)&&console.warn("[apptel:api.leaveAction] was called with a span object, you should just call end on the span instead."),t||(console.warn("[apptel:api.leaveAction] unable to find span with name '".concat(o,"'")),t=this.enterAction(o)),t.end(n,r),this.dispatch("actionEnded",t)}},{key:"enterAction",value:function(t){for(var n=null,r="default",o=null,i=Array.prototype.slice.call(arguments,1,arguments.length),a=0;a<i.length;a++)switch(e(i[a])){case"object":n=i[a];break;case"string":r=i[a];break;case"number":o=Math.round(i[a]);break;case"boolean":break;default:console.info("[apptel:api.enterAction] argument ".concat(i[a]," was not processed for ").concat(t," - unexpected type"))}this._spanCounter++;var s=this._spanCounter,c=new E(s,t,r,o,n);return this._spans.push(c),c}},{key:"hasSpan",value:function(t){return this.findSpans(t).length>0}},{key:"findSpans",value:function(t){var e=[],n=this._unreportedSpans[t],r=this._spans.find((function(e){return e.name==t}));return n&&(e=e.concat(n)),r&&(e=r&&e.concat(r)),e}},{key:"getUnreportedSpans",value:function(){return this._unreportedSpans}},{key:"exportStats",value:function(){this._processSpans();var t=(new I).exportStats();return t.longTaskStats=this.longTaskStats,t}},{key:"submitStats",value:function(t){return this._processSpans(),new I(t).submit()}},{key:"setPage",value:function(t,e){window.dtrum&&window.dtrum.setPage({name:t,group:e})}}]),t}(),P=function(){function t(e,n){var r=this;o(this,t),s(this,"_parsePCCookie",(function(){var t=r._getCookie("PC_1_0");if(!t)return null;var e=window.decodeURIComponent(t).split("|"),n={};return e.forEach((function(t){try{e=t,(r=new RegExp("(.{0,})=(.{0,})","g").exec(e))&&r.length>2&&(n[r[1]]=r[2])}catch(t){}var e,r})),n.pm&&(n.pm=window.decodeURIComponent(n.pm)),n.apc&&(n.apc=window.decodeURIComponent(n.apc)),n.AOC&&(n.AOC=window.decodeURIComponent(n.AOC)),n})),s(this,"_getCookie",(function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null})),this._api=e,this._sessionMonitorId=null,this._sessionStore={},this._otherStore={},this._currentUserId="NOT_SET",this.initialize()}return a(t,[{key:"initialize",value:function(){var t=this;this._api.addListener("sessionChanged",(function(e){t.addSessionProperties(e)})),setTimeout(this.checkForSessionUpdates.bind(this),1e4),this.monitorSessionAttributes()}},{key:"monitorSessionAttributes",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this._sessionMonitorId||(this._sessionMonitorId=window.setInterval(this.checkForSessionUpdates.bind(this),2e4)):null!=this._sessionMonitorId&&(window.clearInterval(this._sessionMonitorId),this._sessionMonitorId=null)}},{key:"checkForSessionUpdates",value:function(){window.requestIdleCallback(this.updateSessionAttributes.bind(this),{timeout:5e3})}},{key:"collectResourceProps",value:function(){var t={};try{var e=window.performance.getEntriesByType("navigation")[0];e&&(t.navType=e.type);var n=window.performance.getEntries().find((function(t){return t.name.includes("apptel.collector.min.js")}));if(n){var r;r=n.transferSize,t.cached=r<2e3}}catch(t){console.error(t),console.warn("[apptel] error collecting resource props")}this.addSessionProperties(t)}},{key:"updateSessionAttributes",value:function(){var t=this;this.collectResourceProps();try{var e=t._parsePCCookie();e&&t.updateUser(e)&&(t.addSessionProperty("userSegment",e.segment||t._getCookie("segment")),t.addSessionProperty("pid",e.pfid),t.addSessionProperty("at",e.pm),t.addSessionProperty("br",t._getCookie("BRAND_1_0")),t.addSessionProperty("av","23.12.17-5"),t.addSessionProperty("channel",window.channel),window.navigator&&(t.addSessionProperty("deviceMemory",window.navigator.deviceMemory),t.addSessionProperty("hc",window.navigator.hardwareConcurrency),t.addSessionProperty("ct",window.navigator.connection&&window.navigator.connection.effectiveType)))}catch(t){console.warn("[apptel:sessionHelper.updateSessionAttributes]: error parsing cookies",t)}}},{key:"updateUser",value:function(t){var e=null;if(e=t.ECI?t.ECI:this._getCookie("primaryEci"),this._storageAvailable("localStorage")){var n=window.localStorage.getItem("apptel-userId");n&&(e=n)}return e!=this._currentUserId&&(this._currentUserId=e,this._currentUserId&&this._api.identifyUser(this._currentUserId),!0)}},{key:"addSessionProperty",value:function(t,e){if(t&&e)try{if(b.includes(t))this._sessionStore[t]=e;else{this._otherStore[t]=e;var n=[];Object.entries(this._otherStore).forEach((function(t){var e=c(t,2),r=e[0],o=e[1];n.push("".concat(r,":").concat(o))})),this._sessionStore.other=n.join("|")}}catch(t){console.warn("[apptel:sessionHelper.addSessionProperty]: error adding session property",t)}}},{key:"addSessionProperties",value:function(t){var e=this;Object.entries(t).forEach((function(t){var n=c(t,2),r=n[0],o=n[1];e.addSessionProperty(r,o)}))}},{key:"_storageAvailable",value:function(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}}]),t}(),M=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(o(this,t),s(this,"addActionProperty",(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(r.active&&t){r.span.props[t]=e;try{if(n&&Array.isArray(o)&&o.length>0&&Number.isFinite(e)&&!o.find((function(t){Number.isFinite(t)}))){var i=null;if(e>o[o.length-1])i=">".concat(o[o.length-1]);else for(var a=o.length-1;a>=0;a--)e<=o[a]&&(i=0==a?0==e&&0==o[a]?"0":"<=".concat(o[a]):"".concat(o[a-1]+1,"-").concat(o[a]));r.addActionProperty(n,i)}}catch(t){console.warn("[apptel:userAction.addActionProperty]: error setting action property",t)}}})),s(this,"getActionProperty",(function(t){return r.span.props[t]})),this.actionProps={},this.otherActionProps={},this.type=n,this.timeout=t.actionConfig.options.timeout,this.children=[],e=e?e.toLowerCase():""){this.isCritical=!1;var l=t.actionConfig.get(e)||c&&t.actionConfig.get(c);l&&(this.isCritical=!0,l.name&&this.updateName(l.name),l.timeout&&(this.timeout=l.timeout)),this.active=!0;var u=n;"aa"!=u&&(u="ca"),this.span=t.api.enterAction(e,u,a),this.span.isTransient=i,this.span.stop=a+1,this.span.props.initiator=c,this.timeoutHandle=window.setTimeout((function(){r.endAction(!1,!0)}),this.timeout)}else this.span={props:{}},this.active=!1}return a(t,[{key:"endAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(clearTimeout(this.timeoutHandle),!this.active)return null;e&&this.updateEndTime(),this.endChildActions();var r=this.span.stop-this.span.start;return r>this.timeout&&(this.span.name="to|"+this.span.name,console.warn("[apptel:userAction.endAction] timeout on action ".concat(this.span.name," - ").concat(r,"ms"))),n||(this.span.type="ca"),t.api.leaveAction(this.span),this.active=!1,r}},{key:"okToStartNewAction",value:function(t,e){if(this.active&&this.isCritical){var n=y();return!!(this.timeout&&n>this.span.start+this.timeout)}return!0}},{key:"updateName",value:function(t){if(this.active){if(t.startsWith("aa|")&&!this.span.name.startsWith("aa|"))return;this.span.name=t.toLowerCase()}}},{key:"updateEndTime",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.active&&(this.span.stop=t||y())}},{key:"startChildAction",value:function(e,n,r){var o=new t(e,r,n);o.span.isNested=!0,this.children.push(o)}},{key:"endChildAction",value:function(t){if(t){var e=t.toLowerCase(),n=this.children.find((function(t){return 1==t.active&&t.span.name==e}));n?(n.endAction(!0),"associate"==n.type?this.endAction(!0):"composite"==n.type&&(this.children.find((function(t){return 1==t.active&&"composite"==t.type}))||this.endAction(!0))):console.warn("[apptel:userAction.endChildAction] No active child action (".concat(t,")"))}else console.warn("[apptel:userAction.endChildAction] Must supply a name to end the child action!")}},{key:"endChildActions",value:function(){if(this.children.length>1){this.children.filter((function(t){return 1==t.active})).forEach((function(t){t.updateName("fc|"+t.span.name),t.endAction(!0)}));var t=[],e=[];this.children.forEach((function(n){t.push(n.span.name),e.push(n.span.stop-n.span.start)})),this.span.props.childActions=t.join(","),this.span.props.cats=e.join(",")}}}]),t}();function j(t){var e=this;M.api=t,this.api=t,M.actionConfig=t.actionConfig,this.asyncActions=[],this.clientAction=new M,this.sessionProps={},this.startClientAction=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"ca";try{if(!t)return;if(n||(n=y()),e.clientAction.active){if(e.clientAction.isCritical&&!e.clientAction.okToStartNewAction(t,r))return;e.endClientAction(null,!1,!0)}e.clientAction=new M(t,i,!1,n,r),o&&e.addActionProperty("prev",o)}catch(t){console.warn("[apptel:actionManager.startClientAction]: error starting action",t)}},this.endClientAction=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t&&e.updateClientActionName(t),e.clientAction.endAction(n,r)}catch(t){console.warn("[apptel:actionManager.endClientAction]: error ending action",t)}},this.updateClientActionName=function(t){e.clientAction.active&&t&&e.clientAction.updateName(t)},this.updateClientActionEndTime=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.clientAction.active&&e.clientAction.updateEndTime(t)},this.startChildAction=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"aggregate";try{if(!t)return void console.warn("[apptel:actionManager.startChildAction] Cannot enter an action without a name!");if(!e.clientAction.active)return void console.warn("[apptel:actionManager.startChildAction] [WARN] Cannot start child action (".concat(t,") because the parent Client Action (").concat(e.clientAction.span.name,") is not active!"));e.clientAction.startChildAction(t,n,r)}catch(t){console.warn("[apptel:actionManager.startChildAction]: error starting action",t)}},this.endChildAction=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{e.clientAction.active&&e.clientAction.endChildAction(t)}catch(t){console.warn("[apptel:actionManager.endChildAction]: error ending action",t)}},this.startAsyncAction=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){var r=new M(t,"async");n&&(r.timeout=n),e.asyncActions.push(r)}},this.endAsyncAction=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=e.asyncActions.filter((function(t){return 1==t.active}));if(t&&(n=n.filter((function(e){return e.span.name.endsWith(t.toLowerCase())}))),0!=n.length)return n[n.length-1].endAction(!0)},this.addActionProperty=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e.clientAction.active&&e.clientAction.addActionProperty(t,n,r,o)},this.getActionProperty=function(t){return e.clientAction.active?e.clientAction.getActionProperty(t):null},this.addSessionProperty=function(t,n){e.api.setSessionProperties(Object.fromEntries([[t,n]]))},this.reportError=function(t,n){e.api.reportError(t,n)}}s(M,"api",void 0),s(M,"actionConfig",void 0);var R={serviceTrackingEnabled:!1,lifecycleEventsEnabled:!0,analyticStartEventsEnabled:!0,screenErrorsEnabled:!0},U={"blue:lifecycle:route:batch:end":function(t){this._actionManager.updateClientActionEndTime(t.eventTimeStamp),this._screenInfoStore.getScreenId()&&this._actionManager.updateClientActionName("aa|".concat(this._screenInfoStore.getScreenId().split("?")[0]))},"blue:lifecycle:area:load:begin":function(t){var e=this._actionManager.getActionProperty("numAreaLoad");e||(e=0),e++,this._actionManager.addActionProperty("numAreaLoad",e),this._actionManager.addActionProperty("areasLoaded","yes")}},D=function(){function t(e,n,r){o(this,t),this.options=Object.assign(R,r||{}),this._initialized=!1,this._api=e,this._actionManager=n,this._actionMap={},this._stack=[]}return a(t,[{key:"enable",value:function(){var t=this;t._initialized?console.error("[apptel:blue-events.enable] blue instrumentation already enabled"):(this._loadId=this._api.enterAction("$$framework-load"),window.addEventListener("blueReady",(function(){t._api.leaveAction(t._loadId),t._initialized=!0,window.require&&window.require(["blue/site","analytics/util/stores/screenInfo","blue/event/channel","blue/event/channel/component","analytics/util/streamCollator"],(function(e,n,r,o,i){if(t._screenInfoStore=n,t.options.lifecycleEventsEnabled&&e.enablePerformanceMonitoring((function(e){var n=U[e.type];try{n&&n.call(t,e)}catch(t){console.error("[apptel:blue-events] bluejs event error",t)}})),t.options.analyticStartEventsEnabled){var a=o.asEventStream("action").map((function(e){try{if(!e)return void console.warn("[apptel:blue-events.componentActionEvent] Event object not provided for component action");var n="aa|".concat(e.target.spec.name,"|").concat(e.action);if(e.nonCustomerEvent)return;var r=t._screenInfoStore.getScreenId(),o=r&&r.split("?")[0]||"",i=n=n.toLowerCase();t._actionManager.startClientAction(n,e.eventTimeStamp,i,o,"aa")}catch(t){console.warn("[apptel:blue-events.componentActionEvent] error starting client action",t)}}));(new r).plug(a)}t.options.screenErrorsEnabled&&i(void 0,void 0,void 0,!0,{variableSettingsEvent:!0}).then((function(e){e.length>0&&e[0].onValue((function(e){try{var n=e.component?e.component:"UNKNOWN",r="UNKNOWN";e.payload&&e.payload.data&&(r="".concat(e.payload.data.placement,"-").concat(e.payload.data.variation)),t._actionManager.reportError(n,r)}catch(t){console.error("[apptel:blue-events] error in screenError handler",t)}}))}))}))}),{once:!0}))}}]),t}();!function(t){var e=function(t){var e,n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new I(r||[]);return o(a,"_invoke",{value:C(t,n,s)}),a}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",f="executing",v="completed",y={};function m(){}function g(){}function w(){}var b={};l(b,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(O([])));S&&S!==n&&r.call(S,a)&&(b=S);var A=w.prototype=m.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,s){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function C(t,e,n){var r=d;return function(o,i){if(r===f)throw new Error("Generator is already running");if(r===v){if("throw"===o)throw i;return N()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=p(t,e,n);if("normal"===c.type){if(r=n.done?v:h,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=v,n.method="throw",n.arg=c.arg)}}}function T(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=p(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function O(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}return{next:N}}function N(){return{value:e,done:!0}}return g.prototype=w,o(A,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,c,"GeneratorFunction")),t.prototype=Object.create(A),t},t.awrap=function(t){return{__await:t}},E(k.prototype),l(k.prototype,s,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(A),l(A,c,"Generator"),l(A,a,(function(){return this})),l(A,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=O,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}({exports:{}});var $={serviceTrackingEnabled:!1,lifecycleEventsEnabled:!0,analyticStartEventsEnabled:!0,screenErrorsEnabled:!0},z=function(){function n(t,e,r){o(this,n),this._options=Object.assign($,r||{}),this._api=t,this._actionManager=e}var i,s;return a(n,[{key:"enable",value:function(){var t=this;window.addEventListener("single-spa:before-first-mount",(function(e){var n=v();t._api.enterAction("@octagon/single-spa-load").updateTiming(y(),n)})),window.addEventListener("single-spa:first-mount",(function(e){console.debug("[apptel:OctagonInstrumentation::first-mount]"),t._api.leaveAction("@octagon/single-spa-load")})),window.addEventListener("hostapp:begin-load-app",(function(e){console.debug("@octagon/hostapp/load/".concat(e.detail.name,"-begin")),t._api.enterAction("@octagon/hostapp/load/".concat(e.detail.name))})),window.addEventListener("hostapp:end-load-app",(function(e){console.debug("@octagon/hostapp/load/".concat(e.detail.name,"-end")),t._api.leaveAction("@octagon/hostapp/load/".concat(e.detail.name))})),window.addEventListener("hostapp:begin-app-change",(function(e){console.debug("@octagon/hostapp/change/".concat(e.detail.mountedApp,"-begin")),t._api.enterAction("@octagon/hostapp/change/".concat(e.detail.mountedApp))})),window.addEventListener("hostapp:end-app-change",(function(e){console.debug("@octagon/hostapp/change/".concat(e.detail.mountedApp,"-end")),t._api.leaveAction("@octagon/hostapp/change/".concat(e.detail.mountedApp))})),window.addEventListener("hostapp:begin-load-app-module",(function(e){t._api.enterAction("@octagon/hostapp/load/mod/".concat(e.detail.scope,"/").concat(e.detail.module))})),window.addEventListener("hostapp:end-load-app-module",(function(e){t._api.leaveAction("@octagon/hostapp/load/mod/".concat(e.detail.scope,"/").concat(e.detail.module))})),t.waitForAnalytics()}},{key:"handleAnalyticEvent",value:(s=r(t().mark((function e(n){var r,o,i,a,s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=this,n.payload&&"action"==n.payload.eventType&&(o="aa|".concat(n.component,"|").concat(n.payload.action).toLowerCase(),i=n.payload.timestamp||y(),a=n.payload.txnScreenId,s="oct|".concat(o),r._actionManager.startClientAction(o,i,s,a,"aa"));case 3:case"end":return t.stop()}}),e,this)}))),function(t){return s.apply(this,arguments)})},{key:"waitForAnalytics",value:(i=r(t().mark((function n(){var r,o;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=this,"object"==e(null===(r=window)||void 0===r||null===(r=r.dataLayer)||void 0===r||null===(r=r.analytics)||void 0===r?void 0:r.eventQueue)?(window.dataLayer.analytics.__eventQueue=window.dataLayer.analytics.eventQueue,Object.defineProperty(window.dataLayer.analytics,"eventQueue",{get:function(){return this.__eventQueue},set:function(t){if(t&&t.length>0&&t.length!=this.__eventQueue.length){var e=t[t.length-1];e.event&&o.handleAnalyticEvent(e.event)}this.__eventQueue=t}})):window.setTimeout(o.waitForAnalytics.bind(o),1e3);case 2:case"end":return t.stop()}}),n,this)}))),function(){return i.apply(this,arguments)})}]),n}(),F={serviceTrackingEnabled:!1,lifecycleEventsEnabled:!0,analyticStartEventsEnabled:!0,screenErrorsEnabled:!0},G=function(t){this._api.dispatch("longtaskObserved",t)},q=function(t){if(!(t.duration<300)&&t.name.includes("svc/")){var e=function(t){return t.replaceAll(h,"/xxx/")}(new URL(t.name).pathname),n="svc|".concat(e),r=this._api.enterAction(n,"svc"),o=Math.round(window.performance.timeOrigin+t.startTime),i=Math.round(o+t.duration);this._api.leaveAction(r,i,o)}},H=function(t,e){for(var n=t.getEntries(),r={longtask:G.bind(this),resource:q.bind(this)},o=0;o<n.length;o++){var i=n[o],a=r[i.entryType];a&&a(i)}},Q=function(){function t(e,n){o(this,t),this._options=Object.assign(F,n||{}),this._api=e}return a(t,[{key:"enable",value:function(){try{window.PerformanceObserver&&(this._observer=new window.PerformanceObserver(H.bind(this)),this._observer.observe({entryTypes:["resource","longtask"]}))}catch(t){console.error("[apptel:perf-events.enable] error starting observer")}}}]),t}(),W={click:!0,dblclick:!1,mousedown:!1,mouseup:!1};function J(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";var n=function(t,e){var n=t.nodeType,r=function(t){if(!t.parentNode)return 0;var e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);var n=Array.from(t.parentNode.childNodes);if(n=n.filter((function(n){var r=n.localName;return e.indexOf(n.nodeType)>=0&&r===t.localName})),n.length>=1)return n.indexOf(t)+1;return 0}(t),o="";if(n===Node.ELEMENT_NODE){var i=t.getAttribute("id");if(e&&i)return'//*[@id="'.concat(i,'"]');o=t.localName}else if(n===Node.TEXT_NODE||n===Node.CDATA_SECTION_NODE)o="text()";else{if(n!==Node.COMMENT_NODE)return"";o="comment()"}if(o&&r>1)return"/".concat(o,"[").concat(r,"]");return"/".concat(o)}(t,e);if(e&&n.indexOf("@id")>0)return n;var r="";return t.parentNode&&(r+=J(t.parentNode,!1)),r+=n}var B=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var r=n.events;this._autoInstrumentedEvents=Object.assign({},W,r),this._api=e}return a(t,[{key:"enable",value:function(){var t=this;window.addEventListener("click",(function(e){try{J(e.target,!0);var n=e&&e.target&&e.target.dataset&&e.target.dataset.action;if(n){var r=Math.round(e.timeStamp)+Math.round(window.performance.timeOrigin);t._api.enterAction(n,"default",r)}}catch(t){console.error("[apptel:UserActionInst] error occured in click listener-".concat(t))}}))}}]),t}(),Y="apptel-login-clicked",K=a((function t(e){var n;o(this,t),void 0===String.prototype.replaceAll&&(String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),(function(){return e}))}),window.requestIdleCallback||(window.requestIdleCallback=function(t,e){var n=(e=e||{}).timeout||1,r=window.performance.now();return setTimeout((function(){t({get didTimeout(){return!e.timeout&&window.performance.now()-r-1>n},timeRemaining:function(){return Math.max(0,window.performance.now()-r+1)}})}),1)}),this.userTag=null,this.api=new N,this.instrumentations=[],this.actionManager=new j(this.api),this.sessionHelper=new P(this.api),this.botContextDetected=!!(n=window.navigator.userAgent).includes("Synthetic")||!!n.includes("ThousandEyes"),this.dashboardLoadEventObserved=!1,this.actionManager.sessionProps=this.sessionHelper._sessionStore;var r=new D(this.api,this.actionManager,{serviceTrackingEnabled:!1});r.enable(),this.instrumentations.push(r);var i=new Q(this.api);i.enable(),this.instrumentations.push(i);var a=new z(this.api,this.actionManager);a.enable(),this.instrumentations.push(a);var s=new B(this.api);s.enable(),this.instrumentations.push(s),f.hasItem(Y),this.api.addListener("actionEnded",function(t){var e=this;try{if("@digifa/sendconsenttoamazon"==t.name&&(console.info("[apptel:actionEnded] received sendconsent event, end session"),e.api.endSession()),"$$login-clicked"==t.name&&f.setItem(Y,t.start,null,"/",".chase.com",!1),"@/ovd/dashboard-load"==t.name||"$$dashboard-load"==t.name||t.name.includes("@seur/thirdpartyaccess-app")){var n=v();if(f.hasItem(Y)){var r=v(),o=+f.getItem(Y);o>r&&(f.removeItem(Y),n=o,t.name=t.name+"-secure",console.info("[apptel:actionEnded] corrected dbl to use login-clicked-time for start - ".concat(o)))}if(this.dashboardLoadEventObserved)return t.isTransient=!0,void(t.dtIgnoreReason="duplicate/invalid");if(this.api.hasSpan("login-clicked")){var i=this.findSpans("login-clicked")[0];i.start>n&&(n=i.start,t.name=t.name+"-secure")}t.updateTiming(t.stop,n),this.dashboardLoadEventObserved=!0,console.info("[apptel:actionEnded] ".concat(t.name," - ").concat(t.dur)),setTimeout((function(){e.api.processSpans("dashboard-load")}),200)}}catch(t){console.error(t)}}.bind(this))}));console.info("[apptel:index] version ".concat("23.12.17-5")),function(){if(window.apptel)console.info("[apptel:index.loadApptel] apptel already loaded.");else try{var t=new K;window.apptel=t.api,window.actionManager=t.actionManager,console.info("[apptel:index.loadApptel] loaded on ".concat(window.document.location)),window.apptel.signalLoadEnd()}catch(t){console.error("[apptel:index.loadApptel] error loading apptel:",t)}}()}();
//# sourceMappingURL=apptel.collector.min.js.map
